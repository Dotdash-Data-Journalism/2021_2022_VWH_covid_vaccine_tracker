# Daily CDC Vaccination Update for VeryWell Health

This repository leverages two Github Actions YAML files to take the daily [CDC vaccination by State and equivalent municipality data](https://covid.cdc.gov/covid-data-tracker/COVIDData/getAjaxData?id=vaccination_data) and updates a handful of CSV files that are hooked up to [Datawrapper](https://app.datawrapper.de) visualizations for VeryWell Health's [Vaccine Data Tracker page](https://www.verywellhealth.com/covid-vaccine-distribution-tracker-5097410).

First, the `cdcScrape.yml` file runs three times an hour, every hour, and simply pretty-prints the latest CDC vaccination JSON data into the `cdcVaccines.json` file _only when the data in the original CDC JSON URL has changed_. Theoretically this should only be once a day but there are some days when multiple runs with data corrections occur.

Once a new version of the `cdcVaccines.json` file has been commited to the repo by GH actions, this triggers the `vwChartDataUpdate.yml` file to run the `wvVaccineDataTracker.R` file in a GH action that either updates all of the CSVs in the `chartData` folder with the new day's data or remakes them with the previous day's data, depending on the most recent date in the `cdcFullTable.csv` file in the `chartData` folder.

The `vwVaccineDataTracker.R` R file makes ~~8~~ 7 CSVs in the `chartData` folder that are used for the previously mentioned [VeryWell Health](https://www.verywellhealth.com/) Vaccine Data Tracker. They are in order of creation:

- `cdcFullTable.csv`: A full CSV file of every variable included in the CDC state-by-state vax resource.
- `cdcWWWFormatted.csv`: A CSV of the Total Doses Delivered, Total Doses Adminsisted, People with 1 Dose per 100K, People Complete Vaccinated (Two shots Pfizer/Modera, 1 J&J shot) per 100K for every state and equivalent territory/municipality displayed as a table.
- `cdcMap.csv`: A CSV of the Percentage of Currently Eligible People Fully Vaccinated and the number of Total People Currently Eligible for Vaccination for every state and equivalent territory/municipality displayed as a US chloropleth map.
- `areWeThereYet.csv`: A CSV file of the Percentage of the Population Fully Vaccinated, the Number of Doses Administered in the Last Week, and the Estimated Month/Year when each state will reach 70% of their population fully vaccinated. This is based on the amount of their population currently vaccinated and the number of vaccinations given out in the previous 7 days. The CSV includes every state and equivalent territory/municipality displayed as a table.
- ~~`supplyProjection.csv`: A CSV file of the number of people Fully Vaccinated per 100K, the Population in each state, How far Behind Biden's May 1st deadline of a vaccine available for every adult resident in the state, and the estimated date vaccines will be available for every adult based on the base of vaccine deliveries in the past 7 days. Displayed as a table~~ No longer using.
- `firstVsSecondGrowth.csv`: A CSV file of the 7-day trailing average of first doses administered nationwide and second doses administered nationwide. Displayed as a dual line chart.
- `cdcVaxByCounty.csv`: A CSV of the the percentage of the population who has recieved their first does and has been Fully Vaccinated for every county with data available in the [CDC vaccine data by county resource](https://covid.cdc.gov/covid-data-tracker/COVIDData/getAjaxData?id=vaccination_county_condensed_data) that is updated daily. Data displayed as a US county map.
- `cdcFullVaxByAge.csv`: A CSV of the amount of people fully vaccinated each day by age group as a proportion of full vaccinations completed in said day. Data is taken from the [CDC vaccine data by demographic resource](https://data.cdc.gov/resource/km4m-vcsb.csv) and is displayed as a 100% density plot.